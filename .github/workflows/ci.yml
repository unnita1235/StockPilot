name: CI

on:
  push:
      branches: [main, master, develop]
        pull_request:
            branches: [main, master, develop]

            jobs:
              lint-and-typecheck:
                  name: Lint & Type Check
                      runs-on: ubuntu-latest

                          steps:
                                - name: Checkout code
                                        uses: actions/checkout@v4

                                              - name: Setup Node.js
                                                      uses: actions/setup-node@v4
                                                              with:
                                                                        node-version: '18'
                                                                                  cache: 'npm'

                                                                                        - name: Install dependencies
                                                                                                run: npm ci

                                                                                                      - name: Run linter
                                                                                                              run: npm run lint
                                                                                                              
                                                                                                                    - name: Run type check
                                                                                                                            run: npm run typecheck
                                                                                                                            
                                                                                                                              build:
                                                                                                                                  name: Build
                                                                                                                                      runs-on: ubuntu-latest
                                                                                                                                      
                                                                                                                                          steps:
                                                                                                                                                - name: Checkout code
                                                                                                                                                        uses: actions/checkout@v4
                                                                                                                                                        
                                                                                                                                                              - name: Setup Node.js
                                                                                                                                                                      uses: actions/setup-node@v4
                                                                                                                                                                              with:
                                                                                                                                                                                        node-version: '18'
                                                                                                                                                                                                  cache: 'npm'
                                                                                                                                                                                                  
                                                                                                                                                                                                        - name: Install dependencies
                                                                                                                                                                                                                run: npm ci
                                                                                                                                                                                                                
                                                                                                                                                                                                                      - name: Install server dependencies
                                                                                                                                                                                                                              working-directory: ./server
                                                                                                                                                                                                                                      run: npm ci
                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                            - name: Build frontend
                                                                                                                                                                                                                                                    run: npm run build
                                                                                                                                                                                                                                                            env:
                                                                                                                                                                                                                                                                      NEXT_PUBLIC_API_URL: http://localhost:3001/api
